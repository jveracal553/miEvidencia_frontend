{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Subscriber_1 = require(\"../Subscriber\");\n\nfunction scan(accumulator, seed) {\n  var hasSeed = false;\n\n  if (arguments.length >= 2) {\n    hasSeed = true;\n  }\n\n  return function scanOperatorFunction(source) {\n    return source.lift(new ScanOperator(accumulator, seed, hasSeed));\n  };\n}\n\nexports.scan = scan;\n\nvar ScanOperator = function () {\n  function ScanOperator(accumulator, seed, hasSeed) {\n    if (hasSeed === void 0) {\n      hasSeed = false;\n    }\n\n    this.accumulator = accumulator;\n    this.seed = seed;\n    this.hasSeed = hasSeed;\n  }\n\n  ScanOperator.prototype.call = function (subscriber, source) {\n    return source.subscribe(new ScanSubscriber(subscriber, this.accumulator, this.seed, this.hasSeed));\n  };\n\n  return ScanOperator;\n}();\n\nvar ScanSubscriber = function (_super) {\n  __extends(ScanSubscriber, _super);\n\n  function ScanSubscriber(destination, accumulator, _seed, hasSeed) {\n    var _this = _super.call(this, destination) || this;\n\n    _this.accumulator = accumulator;\n    _this._seed = _seed;\n    _this.hasSeed = hasSeed;\n    _this.index = 0;\n    return _this;\n  }\n\n  Object.defineProperty(ScanSubscriber.prototype, \"seed\", {\n    get: function get() {\n      return this._seed;\n    },\n    set: function set(value) {\n      this.hasSeed = true;\n      this._seed = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ScanSubscriber.prototype._next = function (value) {\n    if (!this.hasSeed) {\n      this.seed = value;\n      this.destination.next(value);\n    } else {\n      return this._tryNext(value);\n    }\n  };\n\n  ScanSubscriber.prototype._tryNext = function (value) {\n    var index = this.index++;\n    var result;\n\n    try {\n      result = this.accumulator(this.seed, value, index);\n    } catch (err) {\n      this.destination.error(err);\n    }\n\n    this.seed = result;\n    this.destination.next(result);\n  };\n\n  return ScanSubscriber;\n}(Subscriber_1.Subscriber);","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;;AAoDA,SAAgBA,IAAhB,CAA2BC,WAA3B,EAAgFC,IAAhF,EAA4F;EAC1F,IAAIC,OAAO,GAAG,KAAd;;EAMA,IAAIC,SAAS,CAACC,MAAV,IAAoB,CAAxB,EAA2B;IACzBF,OAAO,GAAG,IAAV;EACD;;EAED,OAAO,SAASG,oBAAT,CAA8BC,MAA9B,EAAmD;IACxD,OAAOA,MAAM,CAACC,IAAP,CAAY,IAAIC,YAAJ,CAAiBR,WAAjB,EAA8BC,IAA9B,EAAoCC,OAApC,CAAZ,CAAP;EACD,CAFD;AAGD;;AAdDO;;AAgBA;EACE,sBAAoBT,WAApB,EAAiFC,IAAjF,EAAuGC,OAAvG,EAA+H;IAAxB;MAAAA;IAAwB;;IAA3G;IAA6D;IAAsB;EAA4B;;EAEnIM,wCAAKE,UAAL,EAAgCJ,MAAhC,EAA2C;IACzC,OAAOA,MAAM,CAACK,SAAP,CAAiB,IAAIC,cAAJ,CAAmBF,UAAnB,EAA+B,KAAKV,WAApC,EAAiD,KAAKC,IAAtD,EAA4D,KAAKC,OAAjE,CAAjB,CAAP;EACD,CAFD;;EAGF;AAAC,CAND;;AAaA;EAAmCW;;EAYjC,wBAAYC,WAAZ,EAAgDd,WAAhD,EAA6Ge,KAA7G,EACoBb,OADpB,EACoC;IADpC,YAEEc,kBAAMF,WAAN,KAAkB,IAFpB;;IAAgDG;IAA6DA;IACzFA;IAZZA,cAAgB,CAAhB;;EAcP;;EAZDC,sBAAIN,wBAAJ,EAAI,MAAJ,EAAQ;SAAR;MACE,OAAO,KAAKG,KAAZ;IACD,CAFO;SAIR,aAASI,KAAT,EAAqB;MACnB,KAAKjB,OAAL,GAAe,IAAf;MACA,KAAKa,KAAL,GAAaI,KAAb;IACD,CAPO;oBAAA;;EAAA,CAAR;;EAcUP,iCAAV,UAAgBO,KAAhB,EAAwB;IACtB,IAAI,CAAC,KAAKjB,OAAV,EAAmB;MACjB,KAAKD,IAAL,GAAYkB,KAAZ;MACA,KAAKL,WAAL,CAAiBM,IAAjB,CAAsBD,KAAtB;IACD,CAHD,MAGO;MACL,OAAO,KAAKE,QAAL,CAAcF,KAAd,CAAP;IACD;EACF,CAPS;;EASFP,oCAAR,UAAiBO,KAAjB,EAAyB;IACvB,IAAMG,KAAK,GAAG,KAAKA,KAAL,EAAd;IACA,IAAIC,MAAJ;;IACA,IAAI;MACFA,MAAM,GAAG,KAAKvB,WAAL,CAAoB,KAAKC,IAAzB,EAA+BkB,KAA/B,EAAsCG,KAAtC,CAAT;IACD,CAFD,CAEE,OAAOE,GAAP,EAAY;MACZ,KAAKV,WAAL,CAAiBW,KAAjB,CAAuBD,GAAvB;IACD;;IACD,KAAKvB,IAAL,GAAYsB,MAAZ;IACA,KAAKT,WAAL,CAAiBM,IAAjB,CAAsBG,MAAtB;EACD,CAVO;;EAWV;AAAC,CArCD,CAAmCG,uBAAnC","names":["scan","accumulator","seed","hasSeed","arguments","length","scanOperatorFunction","source","lift","ScanOperator","exports","subscriber","subscribe","ScanSubscriber","__extends","destination","_seed","_super","_this","Object","value","next","_tryNext","index","result","err","error","Subscriber_1"],"sources":["../../src/internal/operators/scan.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}