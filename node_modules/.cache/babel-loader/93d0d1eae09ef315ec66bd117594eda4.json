{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar canReportError_1 = require(\"./util/canReportError\");\n\nvar toSubscriber_1 = require(\"./util/toSubscriber\");\n\nvar observable_1 = require(\"./symbol/observable\");\n\nvar pipe_1 = require(\"./util/pipe\");\n\nvar config_1 = require(\"./config\");\n\nvar Observable = function () {\n  function Observable(subscribe) {\n    this._isScalar = false;\n\n    if (subscribe) {\n      this._subscribe = subscribe;\n    }\n  }\n\n  Observable.prototype.lift = function (operator) {\n    var observable = new Observable();\n    observable.source = this;\n    observable.operator = operator;\n    return observable;\n  };\n\n  Observable.prototype.subscribe = function (observerOrNext, error, complete) {\n    var operator = this.operator;\n    var sink = toSubscriber_1.toSubscriber(observerOrNext, error, complete);\n\n    if (operator) {\n      sink.add(operator.call(sink, this.source));\n    } else {\n      sink.add(this.source || config_1.config.useDeprecatedSynchronousErrorHandling && !sink.syncErrorThrowable ? this._subscribe(sink) : this._trySubscribe(sink));\n    }\n\n    if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n      if (sink.syncErrorThrowable) {\n        sink.syncErrorThrowable = false;\n\n        if (sink.syncErrorThrown) {\n          throw sink.syncErrorValue;\n        }\n      }\n    }\n\n    return sink;\n  };\n\n  Observable.prototype._trySubscribe = function (sink) {\n    try {\n      return this._subscribe(sink);\n    } catch (err) {\n      if (config_1.config.useDeprecatedSynchronousErrorHandling) {\n        sink.syncErrorThrown = true;\n        sink.syncErrorValue = err;\n      }\n\n      if (canReportError_1.canReportError(sink)) {\n        sink.error(err);\n      } else {\n        console.warn(err);\n      }\n    }\n  };\n\n  Observable.prototype.forEach = function (next, promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var subscription;\n      subscription = _this.subscribe(function (value) {\n        try {\n          next(value);\n        } catch (err) {\n          reject(err);\n\n          if (subscription) {\n            subscription.unsubscribe();\n          }\n        }\n      }, reject, resolve);\n    });\n  };\n\n  Observable.prototype._subscribe = function (subscriber) {\n    var source = this.source;\n    return source && source.subscribe(subscriber);\n  };\n\n  Observable.prototype[observable_1.observable] = function () {\n    return this;\n  };\n\n  Observable.prototype.pipe = function () {\n    var operations = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      operations[_i] = arguments[_i];\n    }\n\n    if (operations.length === 0) {\n      return this;\n    }\n\n    return pipe_1.pipeFromArray(operations)(this);\n  };\n\n  Observable.prototype.toPromise = function (promiseCtor) {\n    var _this = this;\n\n    promiseCtor = getPromiseCtor(promiseCtor);\n    return new promiseCtor(function (resolve, reject) {\n      var value;\n\n      _this.subscribe(function (x) {\n        return value = x;\n      }, function (err) {\n        return reject(err);\n      }, function () {\n        return resolve(value);\n      });\n    });\n  };\n\n  Observable.create = function (subscribe) {\n    return new Observable(subscribe);\n  };\n\n  return Observable;\n}();\n\nexports.Observable = Observable;\n\nfunction getPromiseCtor(promiseCtor) {\n  if (!promiseCtor) {\n    promiseCtor = config_1.config.Promise || Promise;\n  }\n\n  if (!promiseCtor) {\n    throw new Error('no Promise impl found');\n  }\n\n  return promiseCtor;\n}","map":{"version":3,"mappings":"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","names":["subscribe","_subscribe","Observable","operator","observable","source","observerOrNext","error","complete","sink","toSubscriber_1","add","call","config_1","useDeprecatedSynchronousErrorHandling","syncErrorThrowable","_trySubscribe","syncErrorThrown","syncErrorValue","err","canReportError_1","console","warn","next","promiseCtor","getPromiseCtor","resolve","reject","subscription","_this","value","unsubscribe","subscriber","observable_1","operations","length","pipe_1","x","exports","Promise","Error"],"sources":["../src/internal/Observable.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}